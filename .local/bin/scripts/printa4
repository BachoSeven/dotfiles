#!/bin/sh

# Semplice shellscript che permette di stampare un file in una stampante del Dipartimento di Matematica
# da una qualsiasi shell Unix (Linux, MacOS, BSD...). Funziona anche da remoto!
#
#
# Utilizzo: modifica lo script inserendo il tuo username
#						al posto di "minnocci" nella variabile _user,
#						e poi esegui lo script cos√¨:
#
#						printa4 /percorso/del/Documento.pdf
#

_user="minnocci"

main() {
	for f in $@; do
		scp $f ${_user}@ssh1.dm.unipi.it:/student/home/${_user}/printa4-$f
		ssh -XY ${_user}@ssh1.dm.unipi.it okular /student/home/${_user}/printa4-$f --print
		ssh ${_user}@ssh1.dm.unipi.it rm /student/home/${_user}/printa4-$f
	done
	echo "File temporanei eliminati "
}

usage() {
	printf "\nScript che consente di stampare in Aula 4\n\nUtilizzo: $(basename $0) <DOCUMENTO> <...>\n\nAd esempio:\n\n\t$(basename "$0") ~/GAAL.pdf\n\nNOTA: La variabile del nome utente usato per stampare va modificato all'interno dello script\n\n"
}

error() {
	printf "$@\n" 1>&2
	usage
}

if [ -z "$1" ] ; then
	error "Non hai specificato nessun file..."
else
	case $1 in
	-h|--help)
		usage ;;
	-*)
		error "Opzione invalida: $1" ;;
	*)
		main $@ ;;
	esac
fi
